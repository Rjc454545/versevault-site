<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VerseVault - Scripture-Based Brain Training for Seniors</title>
    <link rel="stylesheet" href="styles.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <script type="text/javascript">
        (function() {
            emailjs.init({
                publicKey: "9k55-ge76O3OwSlXx",
            });
        })();
    </script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">VerseVault</div>
            <div class="nav-links">
                <a href="#home">Home</a>
                <a href="#about">About</a>
                <a href="#features">Features</a>
                <a href="#pricing">Pricing</a>
                <a href="#contact">Contact</a>
                <a href="login.html" class="cta-button">Sign In</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="hero">
        <div class="hero-content">
            <h1>Scripture-Based Brain Training for Seniors</h1>
            <p class="hero-subtitle">Strengthen your mind while deepening your faith with 945 engaging activities</p>
            <div class="hero-buttons">
                <a href="#pricing" class="cta-button large">Start Free Trial</a>
                <a href="#features" class="secondary-button large">Learn More</a>
            </div>
            <div class="hero-features">
                <div class="hero-feature">
                    <span class="checkmark">‚úì</span>
                    <span>21 Exercise Types</span>
                </div>
                <div class="hero-feature">
                    <span class="checkmark">‚úì</span>
                    <span>KJV Scripture Based</span>
                </div>
                <div class="hero-feature">
                    <span class="checkmark">‚úì</span>
                    <span>Memory Care Support</span>
                </div>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="about">
        <div class="container">
            <div class="section-header">
                <h2>About VerseVault</h2>
                <p>Combining Faith and Science for Cognitive Wellness</p>
            </div>
            <div class="about-grid">
                <div class="about-card">
                    <div class="icon">üß†</div>
                    <h3>Evidence-Based Training</h3>
                    <p>Our activities are designed using proven cognitive training principles to support memory, attention, and mental agility.</p>
                </div>
                <div class="about-card">
                    <div class="icon">üìñ</div>
                    <h3>Scripture Foundation</h3>
                    <p>Every exercise incorporates verses from the King James Bible, providing spiritual nourishment alongside mental exercise.</p>
                </div>
                <div class="about-card">
                    <div class="icon">‚ù§Ô∏è</div>
                    <h3>Senior-Focused Design</h3>
                    <p>Large fonts, high contrast, and simple navigation make VerseVault accessible and enjoyable for older adults.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section id="features" class="features">
        <div class="container">
            <div class="section-header">
                <h2>Comprehensive Brain Training</h2>
                <p>21 Different Exercise Types, 945 Unique Activities</p>
            </div>
            <div class="features-grid">
                <div class="feature-card">
                    <h3>Memory Enhancement</h3>
                    <ul>
                        <li>Scripture Memory Match</li>
                        <li>Verse Sequence Recall</li>
                        <li>Pattern Recognition</li>
                        <li>Visual Memory</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <h3>Language Skills</h3>
                    <ul>
                        <li>Word Search Puzzles</li>
                        <li>Crossword Challenges</li>
                        <li>Vocabulary Building</li>
                        <li>Scripture Completion</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <h3>Attention Training</h3>
                    <ul>
                        <li>Focus Exercises</li>
                        <li>Detail Recognition</li>
                        <li>Concentration Tasks</li>
                        <li>Pattern Identification</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <h3>Problem Solving</h3>
                    <ul>
                        <li>Logic Puzzles</li>
                        <li>Scripture Sorting</li>
                        <li>Category Matching</li>
                        <li>Reasoning Exercises</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- Pricing Section -->
    <section id="pricing" class="pricing">
        <div class="container">
            <div class="section-header">
                <h2>Choose Your Plan</h2>
                <p>Flexible options for individuals and families</p>
            </div>
            <div class="pricing-grid">
                <div class="pricing-card">
                    <div class="plan-header">
                        <h3>Free Trial</h3>
                        <div class="price">$0<span>/14 days</span></div>
                    </div>
                    <ul class="plan-features">
                        <li>‚úì Access to all 945 activities</li>
                        <li>‚úì All 21 exercise types</li>
                        <li>‚úì Progress tracking</li>
                        <li>‚úì No credit card required</li>
                    </ul>
                    <button class="cta-button" onclick="openSignupModal('trial')">Start Free Trial</button>
                </div>
                <div class="pricing-card featured">
                    <div class="plan-badge">Most Popular</div>
                    <div class="plan-header">
                        <h3>Individual Plan</h3>
                        <div class="price">$4.99<span>/month</span></div>
                    </div>
                    <ul class="plan-features">
                        <li>‚úì Full access to all activities</li>
                        <li>‚úì Progress tracking & analytics</li>
                        <li>‚úì Personalized recommendations</li>
                        <li>‚úì Priority support</li>
                        <li>‚úì Cancel anytime</li>
                    </ul>
                    <button class="cta-button" onclick="openSignupModal('individual')">Get Started</button>
                </div>
                <div class="pricing-card">
                    <div class="plan-header">
                        <h3>Family Plan</h3>
                        <div class="price">$9.99<span>/month</span></div>
                    </div>
                    <ul class="plan-features">
                        <li>‚úì Up to 5 family members</li>
                        <li>‚úì Individual progress tracking</li>
                        <li>‚úì Family dashboard</li>
                        <li>‚úì All premium features</li>
                        <li>‚úì Best value</li>
                    </ul>
                    <button class="cta-button" onclick="openSignupModal('family')">Get Started</button>
                </div>
                <div class="pricing-card lifetime">
                    <div class="plan-badge">Seniors 65+</div>
                    <div class="plan-header">
                        <h3>Lifetime Access</h3>
                        <div class="price">FREE<span>/forever</span></div>
                    </div>
                    <ul class="plan-features">
                        <li>‚úì Completely free for seniors</li>
                        <li>‚úì Full lifetime access</li>
                        <li>‚úì All premium features</li>
                        <li>‚úì Priority support</li>
                        <li>‚úì No credit card ever</li>
                    </ul>
                    <button class="cta-button" onclick="openLifetimeModal()">Claim Free Access</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="contact">
        <div class="container">
            <div class="section-header">
                <h2>Get in Touch</h2>
                <p>We're here to help you on your cognitive wellness journey</p>
            </div>
            <div class="contact-grid">
                <div class="contact-info">
                    <h3>Building On The Faith Ministry</h3>
                    <p><strong>Address:</strong><br>St. Louis, Missouri</p>
                    <p><strong>Email:</strong><br>support@versevault.com</p>
                    <p><strong>Ministry Hours:</strong><br>Monday - Friday: 9am - 5pm CST<br>Saturday - Sunday: Closed</p>
                </div>
                <form id="contactForm" class="contact-form">
                    <input type="text" id="contact_name" placeholder="Your Name" required>
                    <input type="email" id="contact_email" placeholder="Your Email" required>
                    <input type="text" id="contact_subject" placeholder="Subject" required>
                    <textarea id="contact_message" rows="5" placeholder="Your Message" required></textarea>
                    <button type="submit" class="cta-button">Send Message</button>
                </form>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>VerseVault</h4>
                    <p>Scripture-based brain training for cognitive wellness and spiritual growth.</p>
                </div>
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <a href="#home">Home</a>
                    <a href="#about">About</a>
                    <a href="#features">Features</a>
                    <a href="#pricing">Pricing</a>
                </div>
                <div class="footer-section">
                    <h4>Support</h4>
                    <a href="#contact">Contact Us</a>
                    <a href="privacy.html">Privacy Policy</a>
                    <a href="terms.html">Terms of Service</a>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 Building On The Faith Ministry. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Signup Modal -->
    <div id="signupModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeSignupModal()">&times;</span>
            <h2>Create Your Account</h2>
            <form id="signupForm">
                <input type="text" id="signup_name" placeholder="Full Name" required>
                <input type="email" id="signup_email" placeholder="Email Address" required>
                <input type="password" id="signup_password" placeholder="Password (min 6 characters)" required>
                <input type="text" id="signup_phone" placeholder="Phone Number (optional)">
                <select id="signup_plan" required>
                    <option value="">Select Plan</option>
                    <option value="trial">Free Trial (14 days)</option>
                    <option value="individual">Individual - $4.99/month</option>
                    <option value="family">Family - $9.99/month</option>
                </select>
                <div class="form-checkbox">
                    <input type="checkbox" id="terms" required>
                    <label for="terms">I agree to the Terms of Service and Privacy Policy</label>
                </div>
                <button type="submit" class="cta-button">Create Account</button>
            </form>
            <p class="modal-footer">Already have an account? <a href="login.html">Sign in</a></p>
        </div>
    </div>

    <!-- Lifetime Access Modal -->
    <div id="lifetimeModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeLifetimeModal()">&times;</span>
            <h2>Claim Your Free Lifetime Access</h2>
            <p class="modal-subtitle">For seniors 65 and older - completely free, forever</p>
            <form id="lifetimeForm">
                <input type="text" id="lifetime_name" placeholder="Full Name" required>
                <input type="email" id="lifetime_email" placeholder="Email Address" required>
                <input type="tel" id="lifetime_phone" placeholder="Phone Number" required>
                <input type="date" id="lifetime_birthdate" placeholder="Date of Birth" required>
                <input type="password" id="lifetime_password" placeholder="Create Password (min 6 characters)" required>
                <div class="form-checkbox">
                    <input type="checkbox" id="lifetime_terms" required>
                    <label for="lifetime_terms">I agree to the Terms of Service and Privacy Policy</label>
                </div>
                <div class="form-checkbox">
                    <input type="checkbox" id="age_verification" required>
                    <label for="age_verification">I verify that I am 65 years of age or older</label>
                </div>
                <button type="submit" class="cta-button">Claim Free Access</button>
            </form>
            <p class="modal-footer">Already have an account? <a href="login.html">Sign in</a></p>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';
        import { getAuth, createUserWithEmailAndPassword } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';
        import { getFirestore, doc, setDoc, getDoc, updateDoc, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyD9zw16lr70vi7LUpcGTDSSfiyi-ae6YeE",
            authDomain: "versevault-11c4c.firebaseapp.com",
            projectId: "versevault-11c4c",
            storageBucket: "versevault-11c4c.firebasestorage.app",
            messagingSenderId: "992547730945",
            appId: "1:992547730945:web:e217ffc3e7aadd4b3bd4a3"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Helper function to send emails via EmailJS
        async function sendEmailViaEmailJS(templateId, templateParams) {
            try {
                console.log('Sending email with template:', templateId);
                console.log('Template parameters:', templateParams);
                
                const response = await emailjs.send(
                    'service_t26v21e',
                    templateId,
                    templateParams
                );
                
                console.log('Email sent successfully:', response);
                return { success: true, response };
            } catch (error) {
                console.error('Email send error:', error);
                return { success: false, error };
            }
        }

        // Get next available lifetime code
        async function getNextLifetimeCode() {
            try {
                const counterRef = doc(db, 'system', 'lifetimeCodeCounter');
                const counterDoc = await getDoc(counterRef);
                
                if (!counterDoc.exists()) {
                    await setDoc(counterRef, { currentCode: 1 });
                    return 'VV-LIFE-2024-0001';
                }
                
                const currentCode = counterDoc.data().currentCode;
                const nextCode = currentCode + 1;
                
                await updateDoc(counterRef, { currentCode: nextCode });
                
                return `VV-LIFE-2024-${String(nextCode).padStart(4, '0')}`;
            } catch (error) {
                console.error('Error getting lifetime code:', error);
                throw error;
            }
        }

        // Modal functions
        window.openSignupModal = function(plan) {
            document.getElementById('signupModal').style.display = 'block';
            document.getElementById('signup_plan').value = plan;
        };

        window.closeSignupModal = function() {
            document.getElementById('signupModal').style.display = 'none';
        };

        window.openLifetimeModal = function() {
            document.getElementById('lifetimeModal').style.display = 'block';
        };

        window.closeLifetimeModal = function() {
            document.getElementById('lifetimeModal').style.display = 'none';
        };

        window.onclick = function(event) {
            const signupModal = document.getElementById('signupModal');
            const lifetimeModal = document.getElementById('lifetimeModal');
            if (event.target == signupModal) {
                signupModal.style.display = 'none';
            }
            if (event.target == lifetimeModal) {
                lifetimeModal.style.display = 'none';
            }
        };

        // Handle regular signup
        document.getElementById('signupForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const name = document.getElementById('signup_name').value;
            const email = document.getElementById('signup_email').value;
            const password = document.getElementById('signup_password').value;
            const phone = document.getElementById('signup_phone').value;
            const plan = document.getElementById('signup_plan').value;

            try {
                const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                const user = userCredential.user;

                await setDoc(doc(db, 'users', user.uid), {
                    name: name,
                    email: email,
                    phone: phone || '',
                    plan: plan,
                    accountType: 'standard',
                    createdAt: serverTimestamp(),
                    trialEndsAt: plan === 'trial' ? new Date(Date.now() + 14 * 24 * 60 * 60 * 1000) : null
                });

                // Send welcome email
                const emailResult = await sendEmailViaEmailJS('template_e4axgqg', {
                    to_email: email,
                    to_name: name,
                    user_name: name,
                    user_email: email,
                    plan_type: plan === 'trial' ? 'Free Trial' : plan === 'individual' ? 'Individual Plan' : 'Family Plan',
                    login_url: 'https://versevault.com/login.html'
                });

                if (!emailResult.success) {
                    console.error('Welcome email failed to send:', emailResult.error);
                }

                // Send admin notification
                const adminResult = await sendEmailViaEmailJS('template_nrp6y2d', {
                    user_name: name,
                    user_email: email,
                    plan_type: plan,
                    account_type: 'Standard',
                    signup_date: new Date().toLocaleString()
                });

                if (!adminResult.success) {
                    console.error('Admin notification failed to send:', adminResult.error);
                }

                alert('Account created successfully! Welcome to VerseVault.');
                window.location.href = 'dashboard.html';
            } catch (error) {
                console.error('Signup error:', error);
                alert('Error creating account: ' + error.message);
            }
        });

        // Handle lifetime access signup
        document.getElementById('lifetimeForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const name = document.getElementById('lifetime_name').value;
            const email = document.getElementById('lifetime_email').value;
            const phone = document.getElementById('lifetime_phone').value;
            const birthdate = document.getElementById('lifetime_birthdate').value;
            const password = document.getElementById('lifetime_password').value;

            // Verify age
            const birth = new Date(birthdate);
            const today = new Date();
            const age = today.getFullYear() - birth.getFullYear();
            const monthDiff = today.getMonth() - birth.getMonth();
            
            if (age < 65 || (age === 65 && monthDiff < 0)) {
                alert('You must be 65 years or older to qualify for lifetime access.');
                return;
            }

            try {
                const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                const user = userCredential.user;

                const lifetimeCode = await getNextLifetimeCode();

                await setDoc(doc(db, 'users', user.uid), {
                    name: name,
                    email: email,
                    phone: phone,
                    birthdate: birthdate,
                    plan: 'lifetime',
                    accountType: 'lifetime',
                    lifetimeCode: lifetimeCode,
                    createdAt: serverTimestamp()
                });

                await setDoc(doc(db, 'lifetimeCodes', lifetimeCode), {
                    code: lifetimeCode,
                    userId: user.uid,
                    userName: name,
                    userEmail: email,
                    issuedAt: serverTimestamp(),
                    status: 'active'
                });

                // Send welcome email with lifetime code
                const emailResult = await sendEmailViaEmailJS('template_e4axgqg', {
                    to_email: email,
                    to_name: name,
                    user_name: name,
                    user_email: email,
                    plan_type: 'Lifetime Access (Seniors 65+)',
                    lifetime_code: lifetimeCode,
                    login_url: 'https://versevault.com/login.html'
                });

                if (!emailResult.success) {
                    console.error('Welcome email failed to send:', emailResult.error);
                }

                // Send lifetime code delivery email
                const codeResult = await sendEmailViaEmailJS('template_lfq6pqo', {
                    to_email: email,
                    to_name: name,
                    user_name: name,
                    lifetime_code: lifetimeCode,
                    activation_date: new Date().toLocaleDateString(),
                    login_url: 'https://versevault.com/login.html'
                });

                if (!codeResult.success) {
                    console.error('Lifetime code email failed to send:', codeResult.error);
                }

                // Send admin notification
                const adminResult = await sendEmailViaEmailJS('template_nrp6y2d', {
                    user_name: name,
                    user_email: email,
                    plan_type: 'Lifetime Access',
                    account_type: 'Lifetime (Senior 65+)',
                    lifetime_code: lifetimeCode,
                    signup_date: new Date().toLocaleString()
                });

                if (!adminResult.success) {
                    console.error('Admin notification failed to send:', adminResult.error);
                }

                alert(`Congratulations! Your lifetime access has been activated.\n\nYour Lifetime Code: ${lifetimeCode}\n\nA confirmation email with your code has been sent to ${email}`);
                window.location.href = 'dashboard.html';
            } catch (error) {
                console.error('Lifetime signup error:', error);
                alert('Error creating account: ' + error.message);
            }
        });

        // Handle contact form
        document.getElementById('contactForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const name = document.getElementById('contact_name').value;
            const email = document.getElementById('contact_email').value;
            const subject = document.getElementById('contact_subject').value;
            const message = document.getElementById('contact_message').value;

            try {
                const result = await sendEmailViaEmailJS('template_contact', {
                    from_name: name,
                    from_email: email,
                    subject: subject,
                    message: message,
                    to_email: 'support@versevault.com'
                });

                if (result.success) {
                    alert('Message sent successfully! We will get back to you soon.');
                    document.getElementById('contactForm').reset();
                } else {
                    alert('Failed to send message. Please try again or email us directly at support@versevault.com');
                }
            } catch (error) {
                console.error('Contact form error:', error);
                alert('Error sending message. Please try again.');
            }
        });
    </script>
</body>
</html>
